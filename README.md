# Telegram-–±–æ—Ç –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –ë–∏—Å—Ç—Ä–æ ¬´–ì–ê–í–†–û–®¬ª

–ë–æ—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –∞—Ç—Ç–µ—Å—Ç–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞. –ó–∞–º–µ–Ω—è–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ¬´–°–µ—Ä–≤–∏—Å –ì—É—Ä—É¬ª.

## üèó –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
restoran/
‚îú‚îÄ‚îÄ bot/                    # Telegram-–±–æ—Ç (aiogram 3)
‚îÇ   ‚îú‚îÄ‚îÄ main.py            # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ keyboards/         # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ middlewares/       # Middleware (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
‚îÇ   ‚îî‚îÄ‚îÄ routers/           # –†–æ—É—Ç–µ—Ä—ã –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º
‚îú‚îÄ‚îÄ admin/                  # –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (FastAPI)
‚îÇ   ‚îú‚îÄ‚îÄ main.py            # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –∞–¥–º–∏–Ω–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ routers/           # API —Ä–æ—É—Ç–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ templates/         # HTML —à–∞–±–ª–æ–Ω—ã
‚îÇ   ‚îî‚îÄ‚îÄ auth.py            # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ database/               # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ models.py          # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ database.py        # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ repositories/      # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (CRUD)
‚îú‚îÄ‚îÄ scripts/               # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ init_test_data.py  # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îî‚îÄ‚îÄ create_excel_templates.py
‚îú‚îÄ‚îÄ excel_templates/       # –®–∞–±–ª–æ–Ω—ã Excel –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞
‚îú‚îÄ‚îÄ config.py              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ requirements.txt       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ docker-compose.yml     # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ .env                   # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# –∏–ª–∏ venv\Scripts\activate  # Windows

pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

```env
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
DATABASE_URL=postgresql+asyncpg://postgres:password@localhost:5432/restoran_bot
ADMIN_USERNAME=admin
ADMIN_PASSWORD=–≤–∞—à_–ø–∞—Ä–æ–ª—å
SECRET_KEY=—Å–ª—É—á–∞–π–Ω–∞—è_—Å—Ç—Ä–æ–∫–∞
```

### 3. –ó–∞–ø—É—Å–∫ —Å Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f bot
docker-compose logs -f admin
```

### 4. –ó–∞–ø—É—Å–∫ –±–µ–∑ Docker

```bash
# –ó–∞–ø—É—Å–∫ PostgreSQL (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
# –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö restoran_bot

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
python scripts/init_test_data.py

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ (–≤ –æ–¥–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
python -m bot.main

# –ó–∞–ø—É—Å–∫ –∞–¥–º–∏–Ω–∫–∏ (–≤ –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
python -m admin.main
```

## üì± –§—É–Ω–∫—Ü–∏–∏ –±–æ—Ç–∞

### –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- **üçΩ –ú–µ–Ω—é** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –º–µ–Ω—é –∫—É—Ö–Ω–∏ –∏ –±–∞—Ä–∞
- **üìö –û–±—É—á–µ–Ω–∏–µ** ‚Äî –æ–±—É—á–∞—é—â–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø–æ —Ä–æ–ª–∏
- **üìù –ê—Ç—Ç–µ—Å—Ç–∞—Ü–∏—è** ‚Äî —Ç–µ—Å—Ç—ã —Å —Ç–∞–π–º–µ—Ä–æ–º 30 —Å–µ–∫
- **üö´ –°—Ç–æ–ø-–ª–∏—Å—Ç** ‚Äî –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏
- **‚úÖ Go-–ª–∏—Å—Ç** ‚Äî –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏
- **üí™ –ú–æ—Ç–∏–≤–∞—Ü–∏—è** ‚Äî –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

### –ü—Ä–∏–≤—è–∑–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
1. –ê–¥–º–∏–Ω –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–∞–Ω–µ–ª—å (–§–ò–û, —Ç–µ–ª–µ—Ñ–æ–Ω, —Ä–æ–ª—å)
2. –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –ø–∏—à–µ—Ç –±–æ—Ç—É `/start`
3. –í–≤–æ–¥–∏—Ç –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
4. –ë–æ—Ç –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç Telegram –∫ —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏

## üñ• –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

**URL:** http://localhost:8000

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** Basic Auth (–ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å –∏–∑ .env)

### –†–∞–∑–¥–µ–ª—ã:
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏
- **–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ Excel —Ñ–∞–π–ª–æ–≤
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## üìä –§–æ—Ä–º–∞—Ç—ã Excel –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞

### –ú–µ–Ω—é (menu_template.xlsx)

| name | description | composition | weight_volume | price | category | menu_type | status |
|------|-------------|-------------|---------------|-------|----------|-----------|--------|
| –¶–µ–∑–∞—Ä—å | –ö–ª–∞—Å—Å–∏–∫–∞ | –ö—É—Ä–∏—Ü–∞, —Å–∞–ª–∞—Ç... | 250–≥ | 450 | –°–∞–ª–∞—Ç—ã | –∫—É—Ö–Ω—è | normal |

- **menu_type**: `–∫—É—Ö–Ω—è` –∏–ª–∏ `–±–∞—Ä`
- **status**: `normal`, `stop`, `go`

### –û–±—É—á–µ–Ω–∏–µ (training_template.xlsx)

| title | description | content | role | order_num |
|-------|-------------|---------|------|-----------|
| –°–µ—Ä–≤–∏—Å | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç... | –æ—Ñ–∏—Ü–∏–∞–Ω—Ç | 1 |

- **role**: `—Ö–æ—Å—Ç–µ—Å`, `–æ—Ñ–∏—Ü–∏–∞–Ω—Ç`, `–±–∞—Ä–º–µ–Ω`, `–º–µ–Ω–µ–¥–∂–µ—Ä`

### –¢–µ—Å—Ç—ã (tests_template.xlsx)

**–õ–∏—Å—Ç "tests":**
| id | title | description | role | passing_score | max_attempts | time_per_question |
|----|-------|-------------|------|---------------|--------------|-------------------|
| 1 | –¢–µ—Å—Ç 1 | –û–ø–∏—Å–∞–Ω–∏–µ | –æ—Ñ–∏—Ü–∏–∞–Ω—Ç | 70 | 3 | 30 |

**–õ–∏—Å—Ç "questions":**
| id | test_id | text | order_num |
|----|---------|------|-----------|
| 1 | 1 | –¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞ | 1 |

**–õ–∏—Å—Ç "answers":**
| question_id | text | is_correct |
|-------------|------|------------|
| 1 | –í–∞—Ä–∏–∞–Ω—Ç –ê | true |
| 1 | –í–∞—Ä–∏–∞–Ω—Ç –ë | false |

### –°—Ç–æ–ø/Go-–ª–∏—Å—Ç (stopgo_template.xlsx)

| name | status |
|------|--------|
| –°—Ç–µ–π–∫ –†–∏–±–∞–π | stop |
| –ö–∞–ø—É—á–∏–Ω–æ | go |

### –ú–æ—Ç–∏–≤–∞—Ü–∏—è (motivation_template.xlsx)

| text |
|------|
| –í—ã –¥–µ–ª–∞–µ—Ç–µ –æ—Ç–ª–∏—á–Ω—É—é —Ä–∞–±–æ—Ç—É! |

## üõ† –°–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤ Excel

```bash
python scripts/create_excel_templates.py
```

–®–∞–±–ª–æ–Ω—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –≤ –ø–∞–ø–∫–µ `excel_templates/`

## üë• –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

| –†–æ–ª—å | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|----------|
| –•–æ—Å—Ç–µ—Å | `hostess` | –í—Å—Ç—Ä–µ—á–∞ –≥–æ—Å—Ç–µ–π |
| –û—Ñ–∏—Ü–∏–∞–Ω—Ç | `waiter` | –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ |
| –ë–∞—Ä–º–µ–Ω | `bartender` | –ë–∞—Ä |
| –ú–µ–Ω–µ–¥–∂–µ—Ä | `manager` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ |

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|----------|--------------|
| `BOT_TOKEN` | –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ | ‚Äî |
| `DATABASE_URL` | URL PostgreSQL | postgresql+asyncpg://... |
| `ADMIN_USERNAME` | –õ–æ–≥–∏–Ω –∞–¥–º–∏–Ω–∫–∏ | admin |
| `ADMIN_PASSWORD` | –ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∫–∏ | admin |
| `SECRET_KEY` | –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á | ‚Äî |
| `DEBUG` | –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ | false |

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ—Å—Ç–æ–≤

–ù–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞:
- **passing_score** ‚Äî –ø—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª (%)
- **max_attempts** ‚Äî –º–∞–∫—Å–∏–º—É–º –ø–æ–ø—ã—Ç–æ–∫
- **time_per_question** ‚Äî —Å–µ–∫—É–Ω–¥ –Ω–∞ –≤–æ–ø—Ä–æ—Å

## üìù API Endpoints (–∞–¥–º–∏–Ω–∫–∞)

```
GET  /                     # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
GET  /users/               # –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
POST /users/add            # –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
GET  /users/edit/{id}      # –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
POST /users/edit/{id}      # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
POST /users/toggle/{id}    # –í–∫–ª/–≤—ã–∫–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

GET  /import/              # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∏–º–ø–æ—Ä—Ç–∞
POST /import/menu          # –ò–º–ø–æ—Ä—Ç –º–µ–Ω—é
POST /import/training      # –ò–º–ø–æ—Ä—Ç –æ–±—É—á–µ–Ω–∏—è
POST /import/tests         # –ò–º–ø–æ—Ä—Ç —Ç–µ—Å—Ç–æ–≤
POST /import/stopgo        # –ò–º–ø–æ—Ä—Ç —Å—Ç–æ–ø/go
POST /import/motivation    # –ò–º–ø–æ—Ä—Ç –º–æ—Ç–∏–≤–∞—Ü–∏–∏

GET  /stats/               # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–æ–≤
GET  /health               # Health check
```

## üê≥ Docker –∫–æ–º–∞–Ω–¥—ã

```bash
# –ó–∞–ø—É—Å–∫
docker-compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

# –õ–æ–≥–∏
docker-compose logs -f

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞
docker-compose up -d --build

# –í—Ö–æ–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose exec bot bash
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

**–§–∏–ª–∏–∞–ª:** –ë–∏—Å—Ç—Ä–æ ¬´–ì–ê–í–†–û–®¬ª (—É–ª. –ü—É—à–∫–∏–Ω—Å–∫–∞—è 36/69)

---

¬© 2024 –ë–∏—Å—Ç—Ä–æ ¬´–ì–ê–í–†–û–®¬ª
