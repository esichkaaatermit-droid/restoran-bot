{% extends "base.html" %}

{% block title %}Импорт данных{% endblock %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">Импорт данных из Excel</h1>
</div>

<div class="row">
    <!-- Импорт меню -->
    <div class="col-md-6 mb-4">
        <div class="card h-100">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="bi bi-menu-button"></i> Меню (кухня + бар)</h5>
            </div>
            <div class="card-body">
                <p class="text-muted small">
                    Колонки: <code>name</code>, <code>description</code>, <code>composition</code>, 
                    <code>weight_volume</code>, <code>price</code>*, <code>category</code>*, 
                    <code>menu_type</code>* (кухня/бар), <code>status</code> (normal/stop/go)
                </p>
                <form method="post" action="/import/menu" enctype="multipart/form-data">
                    <div class="mb-3">
                        <input type="file" class="form-control" name="file" accept=".xlsx,.xls" required>
                    </div>
                    <div class="mb-3">
                        <input type="text" class="form-control" name="branch" value="{{ default_branch }}" required>
                    </div>
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="menu_replace" name="replace_existing">
                        <label class="form-check-label" for="menu_replace">Заменить существующие данные</label>
                    </div>
                    <button type="submit" class="btn btn-primary">Загрузить</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Импорт обучения -->
    <div class="col-md-6 mb-4">
        <div class="card h-100">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0"><i class="bi bi-book"></i> Обучающие материалы</h5>
            </div>
            <div class="card-body">
                <p class="text-muted small">
                    Колонки: <code>title</code>*, <code>description</code>, <code>content</code>*, 
                    <code>role</code>* (хостес/официант/бармен/менеджер), <code>order_num</code>
                </p>
                <form method="post" action="/import/training" enctype="multipart/form-data">
                    <div class="mb-3">
                        <input type="file" class="form-control" name="file" accept=".xlsx,.xls" required>
                    </div>
                    <div class="mb-3">
                        <input type="text" class="form-control" name="branch" value="{{ default_branch }}" required>
                    </div>
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="training_replace" name="replace_existing">
                        <label class="form-check-label" for="training_replace">Заменить существующие данные</label>
                    </div>
                    <button type="submit" class="btn btn-success">Загрузить</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Импорт тестов -->
    <div class="col-md-6 mb-4">
        <div class="card h-100">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0"><i class="bi bi-patch-question"></i> Тесты (аттестация)</h5>
            </div>
            <div class="card-body">
                <p class="text-muted small">
                    Excel с 3 листами:<br>
                    <strong>tests:</strong> <code>id</code>, <code>title</code>*, <code>description</code>, <code>role</code>*, 
                    <code>passing_score</code>, <code>max_attempts</code>, <code>time_per_question</code><br>
                    <strong>questions:</strong> <code>id</code>, <code>test_id</code>*, <code>text</code>*, <code>order_num</code><br>
                    <strong>answers:</strong> <code>question_id</code>*, <code>text</code>*, <code>is_correct</code>*
                </p>
                <form method="post" action="/import/tests" enctype="multipart/form-data">
                    <div class="mb-3">
                        <input type="file" class="form-control" name="file" accept=".xlsx,.xls" required>
                    </div>
                    <div class="mb-3">
                        <input type="text" class="form-control" name="branch" value="{{ default_branch }}" required>
                    </div>
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="tests_replace" name="replace_existing">
                        <label class="form-check-label" for="tests_replace">Заменить существующие данные</label>
                    </div>
                    <button type="submit" class="btn btn-info">Загрузить</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Импорт стоп/go листа -->
    <div class="col-md-6 mb-4">
        <div class="card h-100">
            <div class="card-header bg-warning">
                <h5 class="mb-0"><i class="bi bi-exclamation-triangle"></i> Стоп/Go-лист</h5>
            </div>
            <div class="card-body">
                <p class="text-muted small">
                    Обновление статусов существующих позиций меню.<br>
                    Колонки: <code>name</code>* (точное название), <code>status</code>* (stop/go/normal)
                </p>
                <form method="post" action="/import/stopgo" enctype="multipart/form-data">
                    <div class="mb-3">
                        <input type="file" class="form-control" name="file" accept=".xlsx,.xls" required>
                    </div>
                    <div class="mb-3">
                        <input type="text" class="form-control" name="branch" value="{{ default_branch }}" required>
                    </div>
                    <button type="submit" class="btn btn-warning">Загрузить</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Импорт мотивации -->
    <div class="col-md-6 mb-4">
        <div class="card h-100">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0"><i class="bi bi-emoji-smile"></i> Мотивационные сообщения</h5>
            </div>
            <div class="card-body">
                <p class="text-muted small">
                    Колонки: <code>text</code>* (текст сообщения)
                </p>
                <form method="post" action="/import/motivation" enctype="multipart/form-data">
                    <div class="mb-3">
                        <input type="file" class="form-control" name="file" accept=".xlsx,.xls" required>
                    </div>
                    <button type="submit" class="btn btn-secondary">Загрузить</button>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="alert alert-info mt-2">
    <i class="bi bi-info-circle"></i> 
    <strong>Примечание:</strong> Колонки отмеченные * являются обязательными. 
    Скачайте <a href="/import/templates">шаблоны Excel</a> для правильного формата данных.
</div>
{% endblock %}
